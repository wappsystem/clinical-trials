<div id=D__ID>
    <div>
        VmInclude:__CURRENT_PATH__/../../components/grid.v1h.html
    </div>
    <script>
        function F__ID(){
            //-------------------------------------
            VmInclude:__COMPONENT__/module/grid.v1.js
            //-------------------------------------
            var fields="Project ID|UID,Site,Project Name|project_name,Phone|phone,Thank You Comments|thank_you_comments";
            m.fields="_Form,"+fields+",Submit Date|DateTime,Submitted by|Author,_Delete";
            m.form_fields=fields;
            //-------------------------------------
            var site_tid=$vm.module_list[m.prefix+'site-data'].table_id;
            //-------------------------------------
            m.load=function(){
                $vm.load_component('https://modules.wappsystem.com.au/clinical-trials/components/help.html','section_help__ID');
                $("#title__ID").text('SHQ Projects');
            }
            //-------------------------------------
            m.set_req=function(){
                var sql="with tb as (select Information,ID,UID,PUID,DateTime,Modified=Convert(varchar,Modified,127),Author,RowNum=row_number() over (order by ID DESC) from [TABLE-"+m.db_pid+"-@S1] ) ";
                sql+=",tb2 as (select PUID,S2,S3 from [TABLE-"+site_tid+"] ) ";
                sql+="select Information,ID,UID,tb.PUID,DateTime,Modified,Author,RowNum,S2,S3 from tb left join tb2 on tb.UID=tb2.PUID where RowNum between @I6 and @I7";
                var sql_n="select count(ID) from [TABLE-"+m.db_pid+"-@S1]";
            	m.req={cmd:'read',qid:m.qid,sql:sql,sql_n:sql_n,s1:'"'+$('#keyword__ID').val()+'"',I:$('#I__ID').text(),page_size:$('#page_size__ID').val()}
            }
            //--------------------------------------------------------
            $vm.local_url=function(url){
                if(url!=undefined){
                    var urlR=url;
                    if($vm.localhost==true){
                        urlR=urlR.replace('https://spardac.wappsystem.com.au/','http://127.0.0.1:8000/wappsystem/spardac/');
                    }
                }
                return urlR;
            }
        }
    </script>
    <style>
        VmInclude:__COMPONENT__/module/grid.v1.css
        #D__ID{
            height:100%;
            overflow:auto;
            animation: vm_module_fadein 1.0s;
            background-color: #fff;
        }
    </style>
</div>
